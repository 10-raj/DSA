#include <iostream>
#include <stack>
#include <string>
using namespace std;

class InfixConverter {
private:
    stack<char> opStack;
    string postfix;

    int precedence(char op) {
        switch(op) {
            case '^': case '$': return 4;
            case '*': case '/': case '%': return 3;
            case '+': case '-': return 2;
            case '(': case '{': case '[': return 1;
        }
        return 0;
    }

    bool isOperator(char c) {
        return (c=='+' || c=='-' || c=='*' || c=='/' || c=='%' || c=='^' || c=='$');
    }

    bool isOperand(char c) {
        return ((c >= 'a' && c <= 'z') ||
                (c >= 'A' && c <= 'Z') ||
                (c >= '0' && c <= '9'));
    }

public:
    string convert(string infix) {
        postfix = "";
        while(!opStack.empty()) opStack.pop(); // clear stack

        for (size_t i = 0; i < infix.length(); i++) {
            char c = infix[i];
            if(isOperand(c)) {
                postfix += c;
            }
            else if(c=='(' || c=='{' || c=='[') {
                opStack.push(c);
            }
            else if(c==')' || c=='}' || c==']') {
                while(!opStack.empty() && !(opStack.top()=='(' || opStack.top()=='{' || opStack.top()=='[')) {
                    postfix += opStack.top();
                    opStack.pop();
                }
                if(!opStack.empty()) opStack.pop();
            }
            else if(isOperator(c)) {
                while(!opStack.empty() && precedence(opStack.top()) >= precedence(c)) {
                    postfix += opStack.top();
                    opStack.pop();
                }
                opStack.push(c);
            }
        }
        while(!opStack.empty()) {
            postfix += opStack.top();
            opStack.pop();
        }
        return postfix;
    }
};

int main() {
    string infix;
    cout << "Enter infix expression: ";
    cin >> infix;

    InfixConverter converter;
    string postfix = converter.convert(infix);

    cout << "Postfix expression: " << postfix << endl;
    return 0;
}
